---
title: 搭建本博客过程以及遇到坑
date: 2021-03-17 21:16:42
tags: 博客搭建
categories: 工具
---


## 搭建个人博客过程

### 1.安装node.js以及git

略

### 2.安装hexo-cli脚手架

```powershell
npm install -g hexo-cli
```

[![cRGSds.png](https://z3.ax1x.com/2021/04/15/cRGSds.png)](https://imgtu.com/i/cRGSds)
### 3.初始化博客项目

```powershell
//初始化hexo项目
hexo init hexo-blog
```

报错无法识别"hexo",网上查阅资料发现在安装node.js时，配置npm安装全局模块的路径与缓存路径，按照之前csdn上面的教程做，配置环境变量是错误的，这也是为什么之前项目跑不起来的原因，详见https://segmentfault.com/a/1190000023871608。

继续执行该命令，报错

[![cRGAQU.png](https://z3.ax1x.com/2021/04/15/cRGAQU.png)](https://imgtu.com/i/cRGAQU)

查阅资料，计算机上启动 Windows PowerShell 时，执行策略很可能是 Restricted（默认设置）。

查看计算机上的现用执行策略，打开PowerShell 然后输入 **get-executionpolicy**，表明是Restricted

[![cRGEyF.png](https://z3.ax1x.com/2021/04/15/cRGEyF.png)](https://imgtu.com/i/cRGEyF)

以管理员身份打开PowerShell 输入 **set-executionpolicy remotesigned**。

继续执行命令，报错

[![cRGKF1.png](https://z3.ax1x.com/2021/04/15/cRGKF1.png)](https://imgtu.com/i/cRGKF1)

查阅资料发现是开VPN的问题，关掉VPN再执行命令

[![cRGKF1.png](https://z3.ax1x.com/2021/04/15/cRGKF1.png)](https://imgtu.com/i/cRGKF1)

运行项目

[![cRGYeH.md.png](https://z3.ax1x.com/2021/04/15/cRGYeH.md.png)](https://imgtu.com/i/cRGYeH)

```powershell
hexo server
```

[![cRGdYt.png](https://z3.ax1x.com/2021/04/15/cRGdYt.png)](https://imgtu.com/i/cRGdYt)

项目运行在本地4000端口，访问http://localhost:4000 

[![cRGgTs.md.png](https://z3.ax1x.com/2021/04/15/cRGgTs.md.png)](https://imgtu.com/i/cRGgTs)

项目结构：

[![cRGff0.png](https://z3.ax1x.com/2021/04/15/cRGff0.png)](https://imgtu.com/i/cRGff0)

### 4.选择主题，并下载到项目

```powershell
git clone https://github.com/probberechts/hexo-theme-cactus.git themes/cactus  
```

挂了梯子，下载速度很慢

[![cRG7m4.png](https://z3.ax1x.com/2021/04/15/cRG7m4.png)](https://imgtu.com/i/cRG7m4)

查阅资料，发现是挂了梯子，Git也要设置代理，详见：https://blog.csdn.net/isea533/article/details/84748009

梯子端口查看

[![cRGLkR.png](https://z3.ax1x.com/2021/04/15/cRGLkR.png)](https://imgtu.com/i/cRGLkR)

```powershell
git config --global http.https://github.com.proxy socks5://127.0.0.1:10808
```

重新clone

[![cRGvp6.png](https://z3.ax1x.com/2021/04/15/cRGvp6.png)](https://imgtu.com/i/cRGvp6)

删除主题文件下.git文件，方便统一管理

[![cRJP7d.md.png](https://z3.ax1x.com/2021/04/15/cRJP7d.md.png)](https://imgtu.com/i/cRJP7d)

### 5.修改hexo配置文件

打开根目录下config.yml文件，修改主题为：cactus

[![cRJAht.png](https://z3.ax1x.com/2021/04/15/cRJAht.png)](https://imgtu.com/i/cRJAht)

重启服务

```powershell
hexo server
```

访问http://localhost:4000 

[![cRJung.png](https://z3.ax1x.com/2021/04/15/cRJung.png)](https://imgtu.com/i/cRJung)

修改白色背景

在主题文件夹下找到config.yml文件，修改colorscheme属性为white

[![cRJM7j.png](https://z3.ax1x.com/2021/04/15/cRJM7j.png)](https://imgtu.com/i/cRJM7j)

### 6.github新建仓库

[![cRJ0E9.png](https://z3.ax1x.com/2021/04/15/cRJ0E9.png)](https://imgtu.com/i/cRJ0E9)

仓库名有两种方式：

1.[username].github.io

此种命名打包产物必须放在master分支上，访问路径为：https://[username].github.io

2.可以自定义仓库名

打包产物gh-pages分支，访问路径为：https://[username].github.io.[repo]

这里采用第一种方式

[![cRJRDe.png](https://z3.ax1x.com/2021/04/15/cRJRDe.png)](https://imgtu.com/i/cRJRDe)

建好之后

[![cRJhEd.png](https://z3.ax1x.com/2021/04/15/cRJhEd.png)](https://imgtu.com/i/cRJhEd)

### 7.建本地仓库添加远程git地址

```powershell
//在博客项目根目录下初始化本地仓库
git init
//添加远程git地址
git remote add origin git@github.com:JevinZhao/JevinZhao.github.io.git
```

### 8.安装部署插件

作用：将生成好的代码部署到一个具体分支

```powershell
yarn add hexo-deployer-git
```

报错

[![cRJ54I.png](https://z3.ax1x.com/2021/04/15/cRJ54I.png)](https://imgtu.com/i/cRJ54I)

查阅资料，应该是没有安装yarn，那就使用npm吧

```powershell
npm install === yarn 
npm install taco --save === yarn add taco
npm uninstall taco --save === yarn remove taco
npm install taco --save-dev === yarn add taco --dev
npm update --save === yarn upgrade
```

```powershell
npm install hexo-deployer-git --save
```

修改博客项目根目录下config.yml文件

[![cRY92V.png](https://z3.ax1x.com/2021/04/15/cRY92V.png)](https://imgtu.com/i/cRY92V)

### 9.运行部署

```powershell
npm run deploy
//或者
hexo deploy
```

中间可能会让你登录github按提示操作即可

[![cRYEVJ.png](https://z3.ax1x.com/2021/04/15/cRYEVJ.png)](https://imgtu.com/i/cRYEVJ)

完成编译，并将产物public文件夹下的文件提交到github

[![cRYGad.png](https://z3.ax1x.com/2021/04/15/cRYGad.png)](https://imgtu.com/i/cRYGad)

### 10.访问博客主页

https://jevinzhao.github.io/

[![cRYtPI.png](https://z3.ax1x.com/2021/04/15/cRYtPI.png)](https://imgtu.com/i/cRYtPI)

### 11.自动化部署

```powershell
//提交源代码到本地仓库
git add .
git commit -m 'first'
```

创建新分支

[![cRYwM8.png](https://z3.ax1x.com/2021/04/15/cRYwM8.png)](https://imgtu.com/i/cRYwM8)

```powershell
//提交代码到github新分支上
git push --set-upstream origin myblog
```

[![cRYBqg.png](https://z3.ax1x.com/2021/04/15/cRYBqg.png)](https://imgtu.com/i/cRYBqg)

编写自动化部署脚本

在博客项目根目录下建立.github/workflows/deploy.yml文件

[![cRYgGq.png](https://z3.ax1x.com/2021/04/15/cRYgGq.png)](https://imgtu.com/i/cRYgGq)

```yml
name: Build and Deploy
on: [push]
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v2 # If you're using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.
        with:
          persist-credentials: false

      - name: Install and Build 🔧 # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
        run: |
          npm install
          npm run build
        env:
          CI: false

      - name: Deploy 🚀
        uses: JamesIves/github-pages-deploy-action@releases/v3
        with:
          GITHUBTOKEN: ${{ secrets.GITHUBTOKEN }}
          BRANCH: master # The branch the action should deploy to.
          FOLDER: public # The folder the action should deploy.
```

测试：

在源文件下修改博客内容，提交

[![cRYIZ4.png](https://z3.ax1x.com/2021/04/15/cRYIZ4.png)](https://imgtu.com/i/cRYIZ4)

访问博客主页

[![cRYHiR.png](https://z3.ax1x.com/2021/04/15/cRYHiR.png)](https://imgtu.com/i/cRYHiR)


自动部署成功